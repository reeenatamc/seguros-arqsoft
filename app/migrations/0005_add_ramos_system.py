# Generated by Django 5.2.9 on 2026-01-19 21:02

import app.validators
import django.core.validators
import django.db.models.deletion
import simple_history.models
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('app', '0004_add_new_modules'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name='historicalpoliza',
            name='es_gran_contribuyente',
            field=models.BooleanField(default=False, help_text='Si está activo, se aplicarán retenciones de prima (1%) e IVA (100%)', verbose_name='Es Gran Contribuyente'),
        ),
        migrations.AddField(
            model_name='historicalsiniestro',
            name='deducible',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Deducible'),
        ),
        migrations.AddField(
            model_name='historicalsiniestro',
            name='depreciacion',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Depreciación'),
        ),
        migrations.AddField(
            model_name='historicalsiniestro',
            name='email_broker',
            field=models.EmailField(blank=True, help_text='Email específico para este siniestro', max_length=254, verbose_name='Email del Broker'),
        ),
        migrations.AddField(
            model_name='historicalsiniestro',
            name='fecha_firma_indemnizacion',
            field=models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Firma del Recibo de Indemnización'),
        ),
        migrations.AddField(
            model_name='historicalsiniestro',
            name='fecha_limite_deposito',
            field=models.DateField(blank=True, null=True, verbose_name='Fecha Límite de Depósito (72h)'),
        ),
        migrations.AddField(
            model_name='historicalsiniestro',
            name='fecha_notificacion_broker',
            field=models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Notificación al Broker'),
        ),
        migrations.AddField(
            model_name='historicalsiniestro',
            name='fecha_notificacion_responsable',
            field=models.DateField(blank=True, null=True, verbose_name='Fecha de Notificación al Responsable'),
        ),
        migrations.AddField(
            model_name='historicalsiniestro',
            name='fecha_pago',
            field=models.DateField(blank=True, null=True, verbose_name='Fecha de Pago'),
        ),
        migrations.AddField(
            model_name='historicalsiniestro',
            name='fecha_respuesta_esperada',
            field=models.DateField(blank=True, null=True, verbose_name='Fecha de Respuesta Esperada (5 días hábiles)'),
        ),
        migrations.AddField(
            model_name='historicalsiniestro',
            name='suma_asegurada_bien',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Suma Asegurada del Bien'),
        ),
        migrations.AddField(
            model_name='historicalsiniestro',
            name='valor_pagado',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Valor Pagado'),
        ),
        migrations.AddField(
            model_name='historicalsiniestro',
            name='valor_reclamo',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Valor del Reclamo (según proforma)'),
        ),
        migrations.AddField(
            model_name='poliza',
            name='es_gran_contribuyente',
            field=models.BooleanField(default=False, help_text='Si está activo, se aplicarán retenciones de prima (1%) e IVA (100%)', verbose_name='Es Gran Contribuyente'),
        ),
        migrations.AddField(
            model_name='siniestro',
            name='deducible',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Deducible'),
        ),
        migrations.AddField(
            model_name='siniestro',
            name='depreciacion',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Depreciación'),
        ),
        migrations.AddField(
            model_name='siniestro',
            name='email_broker',
            field=models.EmailField(blank=True, help_text='Email específico para este siniestro', max_length=254, verbose_name='Email del Broker'),
        ),
        migrations.AddField(
            model_name='siniestro',
            name='fecha_firma_indemnizacion',
            field=models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Firma del Recibo de Indemnización'),
        ),
        migrations.AddField(
            model_name='siniestro',
            name='fecha_limite_deposito',
            field=models.DateField(blank=True, null=True, verbose_name='Fecha Límite de Depósito (72h)'),
        ),
        migrations.AddField(
            model_name='siniestro',
            name='fecha_notificacion_broker',
            field=models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Notificación al Broker'),
        ),
        migrations.AddField(
            model_name='siniestro',
            name='fecha_notificacion_responsable',
            field=models.DateField(blank=True, null=True, verbose_name='Fecha de Notificación al Responsable'),
        ),
        migrations.AddField(
            model_name='siniestro',
            name='fecha_pago',
            field=models.DateField(blank=True, null=True, verbose_name='Fecha de Pago'),
        ),
        migrations.AddField(
            model_name='siniestro',
            name='fecha_respuesta_esperada',
            field=models.DateField(blank=True, null=True, verbose_name='Fecha de Respuesta Esperada (5 días hábiles)'),
        ),
        migrations.AddField(
            model_name='siniestro',
            name='suma_asegurada_bien',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Suma Asegurada del Bien'),
        ),
        migrations.AddField(
            model_name='siniestro',
            name='valor_pagado',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Valor Pagado'),
        ),
        migrations.AddField(
            model_name='siniestro',
            name='valor_reclamo',
            field=models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Valor del Reclamo (según proforma)'),
        ),
        migrations.CreateModel(
            name='AdjuntoSiniestro',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('tipo_adjunto', models.CharField(choices=[('informe', 'Informe'), ('proforma', 'Proforma'), ('salvamento', 'Acta de Salvamento'), ('preexistencia', 'Certificado de Preexistencia'), ('carta_formal', 'Carta Formal'), ('recibo_indemnizacion', 'Recibo de Indemnización'), ('fotos', 'Fotografías'), ('peritaje', 'Informe de Peritaje'), ('policia', 'Denuncia/Parte Policial'), ('otro', 'Otro')], max_length=30, verbose_name='Tipo de Adjunto')),
                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Documento')),
                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),
                ('archivo', models.FileField(upload_to='siniestros/adjuntos/%Y/%m/', validators=[app.validators.FileValidator()], verbose_name='Archivo')),
                ('requiere_firma', models.BooleanField(default=False, verbose_name='Requiere Firma')),
                ('firmado', models.BooleanField(default=False, verbose_name='Firmado')),
                ('hash_firma', models.CharField(blank=True, max_length=64, verbose_name='Hash de Firma (SHA256)')),
                ('fecha_firma', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Firma')),
                ('ip_firma', models.GenericIPAddressField(blank=True, null=True, verbose_name='IP de Firma')),
                ('fecha_subida', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Subida')),
                ('firmado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='documentos_firmados', to=settings.AUTH_USER_MODEL, verbose_name='Firmado por')),
                ('siniestro', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='adjuntos', to='app.siniestro', verbose_name='Siniestro')),
                ('subido_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='adjuntos_siniestro_subidos', to=settings.AUTH_USER_MODEL, verbose_name='Subido por')),
            ],
            options={
                'verbose_name': 'Adjunto de Siniestro',
                'verbose_name_plural': 'Adjuntos de Siniestro',
                'ordering': ['siniestro', 'tipo_adjunto', '-fecha_subida'],
            },
        ),
        migrations.CreateModel(
            name='ChecklistSiniestroConfig',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Item')),
                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),
                ('es_obligatorio', models.BooleanField(default=True, verbose_name='Es Obligatorio')),
                ('orden', models.PositiveIntegerField(default=0, verbose_name='Orden')),
                ('activo', models.BooleanField(default=True, verbose_name='Activo')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('tipo_siniestro', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='checklist_config', to='app.tiposiniestro', verbose_name='Tipo de Siniestro')),
            ],
            options={
                'verbose_name': 'Configuración de Checklist de Siniestro',
                'verbose_name_plural': 'Configuraciones de Checklist de Siniestro',
                'ordering': ['tipo_siniestro', 'orden', 'nombre'],
                'unique_together': {('tipo_siniestro', 'nombre')},
            },
        ),
        migrations.CreateModel(
            name='GrupoBienes',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Grupo')),
                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),
                ('activo', models.BooleanField(default=True, verbose_name='Activo')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),
                ('creado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='grupos_bienes_creados', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),
                ('poliza', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='grupos_bienes', to='app.poliza', verbose_name='Póliza')),
                ('responsable', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='grupos_bienes', to='app.responsablecustodio', verbose_name='Responsable')),
            ],
            options={
                'verbose_name': 'Grupo de Bienes',
                'verbose_name_plural': 'Grupos de Bienes',
                'ordering': ['nombre'],
            },
        ),
        migrations.AddField(
            model_name='historicalinsuredasset',
            name='grupo',
            field=models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.grupobienes', verbose_name='Grupo de Bienes'),
        ),
        migrations.AddField(
            model_name='insuredasset',
            name='grupo',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='bienes', to='app.grupobienes', verbose_name='Grupo de Bienes'),
        ),
        migrations.CreateModel(
            name='HistoricalNotaCredito',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('numero', models.CharField(db_index=True, max_length=100, verbose_name='Número de Nota de Crédito')),
                ('fecha_emision', models.DateField(verbose_name='Fecha de Emisión')),
                ('monto', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Monto')),
                ('motivo', models.TextField(verbose_name='Motivo')),
                ('estado', models.CharField(choices=[('emitida', 'Emitida'), ('aplicada', 'Aplicada'), ('anulada', 'Anulada')], default='emitida', max_length=20, verbose_name='Estado')),
                ('documento', models.TextField(blank=True, max_length=100, null=True, verbose_name='Documento')),
                ('fecha_creacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),
                ('fecha_modificacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('creado_por', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),
                ('factura', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.factura', verbose_name='Factura')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Historial',
                'verbose_name_plural': 'Historial de cambios',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='NotaCredito',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero', models.CharField(max_length=100, unique=True, verbose_name='Número de Nota de Crédito')),
                ('fecha_emision', models.DateField(verbose_name='Fecha de Emisión')),
                ('monto', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Monto')),
                ('motivo', models.TextField(verbose_name='Motivo')),
                ('estado', models.CharField(choices=[('emitida', 'Emitida'), ('aplicada', 'Aplicada'), ('anulada', 'Anulada')], default='emitida', max_length=20, verbose_name='Estado')),
                ('documento', models.FileField(blank=True, null=True, upload_to='notas_credito/%Y/%m/', verbose_name='Documento')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),
                ('creado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='notas_credito_creadas', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),
                ('factura', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='notas_credito', to='app.factura', verbose_name='Factura')),
            ],
            options={
                'verbose_name': 'Nota de Crédito',
                'verbose_name_plural': 'Notas de Crédito',
                'ordering': ['-fecha_emision'],
            },
        ),
        migrations.CreateModel(
            name='Ramo',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('codigo', models.CharField(max_length=50, unique=True, verbose_name='Código')),
                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Ramo')),
                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),
                ('activo', models.BooleanField(default=True, verbose_name='Activo')),
                ('es_predefinido', models.BooleanField(default=False, verbose_name='Es Predefinido')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),
            ],
            options={
                'verbose_name': 'Ramo',
                'verbose_name_plural': 'Ramos',
                'ordering': ['nombre'],
                'indexes': [models.Index(fields=['codigo'], name='app_ramo_codigo_9cf90e_idx'), models.Index(fields=['activo'], name='app_ramo_activo_3cbac7_idx')],
            },
        ),
        migrations.AddField(
            model_name='grupobienes',
            name='ramo',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='grupos_bienes', to='app.ramo', verbose_name='Ramo'),
        ),
        migrations.CreateModel(
            name='SubtipoRamo',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('codigo', models.CharField(max_length=50, verbose_name='Código')),
                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Subtipo')),
                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),
                ('activo', models.BooleanField(default=True, verbose_name='Activo')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('ramo', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='subtipos', to='app.ramo', verbose_name='Ramo')),
            ],
            options={
                'verbose_name': 'Subtipo de Ramo',
                'verbose_name_plural': 'Subtipos de Ramo',
                'ordering': ['ramo__nombre', 'nombre'],
                'unique_together': {('ramo', 'codigo')},
            },
        ),
        migrations.CreateModel(
            name='HistoricalDetallePolizaRamo',
            fields=[
                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),
                ('numero_factura', models.CharField(blank=True, max_length=100, verbose_name='N° Factura')),
                ('documento_contable', models.CharField(blank=True, max_length=100, verbose_name='Doc. Contable')),
                ('suma_asegurada', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Suma Asegurada')),
                ('total_prima', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Prima Total')),
                ('contribucion_superintendencia', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Contribución Superintendencia (3.5%)')),
                ('emision', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Emisión')),
                ('seguro_campesino', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Seguro Campesino (0.5%)')),
                ('base_imponible', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Base Imponible')),
                ('iva', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='IVA (15%)')),
                ('total_facturado', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Total Facturado')),
                ('retencion_prima', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Retención Prima (1%)')),
                ('retencion_iva', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Retención IVA (100%)')),
                ('valor_por_pagar', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Valor por Pagar')),
                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),
                ('fecha_creacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),
                ('fecha_modificacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('poliza', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.poliza', verbose_name='Póliza')),
                ('ramo', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.ramo', verbose_name='Ramo')),
                ('subtipo_ramo', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.subtiporamo', verbose_name='Subtipo de Ramo')),
            ],
            options={
                'verbose_name': 'Historial',
                'verbose_name_plural': 'Historial de cambios',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.AddField(
            model_name='grupobienes',
            name='subtipo_ramo',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='grupos_bienes', to='app.subtiporamo', verbose_name='Subtipo de Ramo'),
        ),
        migrations.CreateModel(
            name='DetallePolizaRamo',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero_factura', models.CharField(blank=True, max_length=100, verbose_name='N° Factura')),
                ('documento_contable', models.CharField(blank=True, max_length=100, verbose_name='Doc. Contable')),
                ('suma_asegurada', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Suma Asegurada')),
                ('total_prima', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Prima Total')),
                ('contribucion_superintendencia', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Contribución Superintendencia (3.5%)')),
                ('emision', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Emisión')),
                ('seguro_campesino', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Seguro Campesino (0.5%)')),
                ('base_imponible', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Base Imponible')),
                ('iva', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='IVA (15%)')),
                ('total_facturado', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Total Facturado')),
                ('retencion_prima', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Retención Prima (1%)')),
                ('retencion_iva', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Retención IVA (100%)')),
                ('valor_por_pagar', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Valor por Pagar')),
                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),
                ('poliza', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='detalles_ramo', to='app.poliza', verbose_name='Póliza')),
                ('ramo', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='detalles_poliza', to='app.ramo', verbose_name='Ramo')),
                ('subtipo_ramo', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='detalles_poliza', to='app.subtiporamo', verbose_name='Subtipo de Ramo')),
            ],
            options={
                'verbose_name': 'Detalle de Póliza por Ramo',
                'verbose_name_plural': 'Detalles de Póliza por Ramo',
                'ordering': ['poliza', 'ramo__nombre'],
            },
        ),
        migrations.CreateModel(
            name='ChecklistSiniestro',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('completado', models.BooleanField(default=False, verbose_name='Completado')),
                ('fecha_completado', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Completado')),
                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('completado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='checklist_completados', to=settings.AUTH_USER_MODEL, verbose_name='Completado por')),
                ('siniestro', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='checklist_items', to='app.siniestro', verbose_name='Siniestro')),
                ('config_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='instancias', to='app.checklistsiniestroconfig', verbose_name='Item de Checklist')),
            ],
            options={
                'verbose_name': 'Item de Checklist de Siniestro',
                'verbose_name_plural': 'Items de Checklist de Siniestro',
                'ordering': ['siniestro', 'config_item__orden'],
                'unique_together': {('siniestro', 'config_item')},
            },
        ),
        migrations.CreateModel(
            name='NotificacionEmail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('tipo', models.CharField(choices=[('siniestro_broker', 'Siniestro a Broker'), ('siniestro_responsable', 'Siniestro a Responsable'), ('siniestro_cierre', 'Cierre de Siniestro'), ('alerta_respuesta', 'Alerta de Respuesta Pendiente'), ('alerta_deposito', 'Alerta de Depósito Pendiente'), ('poliza_vencimiento', 'Vencimiento de Póliza'), ('factura_vencimiento', 'Vencimiento de Factura'), ('renovacion_pendiente', 'Renovación Pendiente'), ('otro', 'Otro')], max_length=30, verbose_name='Tipo de Notificación')),
                ('destinatario', models.EmailField(max_length=254, verbose_name='Destinatario')),
                ('cc', models.TextField(blank=True, verbose_name='CC (separados por coma)')),
                ('asunto', models.CharField(max_length=300, verbose_name='Asunto')),
                ('contenido', models.TextField(verbose_name='Contenido del Email')),
                ('contenido_html', models.TextField(blank=True, verbose_name='Contenido HTML')),
                ('estado', models.CharField(choices=[('pendiente', 'Pendiente'), ('enviado', 'Enviado'), ('fallido', 'Fallido'), ('rebotado', 'Rebotado')], default='pendiente', max_length=20, verbose_name='Estado')),
                ('enviado', models.BooleanField(default=False, verbose_name='Enviado')),
                ('fecha_envio', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Envío')),
                ('intentos', models.PositiveIntegerField(default=0, verbose_name='Intentos de Envío')),
                ('error_mensaje', models.TextField(blank=True, verbose_name='Mensaje de Error')),
                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('creado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='notificaciones_creadas', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),
                ('factura', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='notificaciones_email', to='app.factura', verbose_name='Factura')),
                ('poliza', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='notificaciones_email', to='app.poliza', verbose_name='Póliza')),
                ('siniestro', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='notificaciones_email', to='app.siniestro', verbose_name='Siniestro')),
            ],
            options={
                'verbose_name': 'Notificación de Email',
                'verbose_name_plural': 'Notificaciones de Email',
                'ordering': ['-fecha_creacion'],
                'indexes': [models.Index(fields=['tipo', 'estado'], name='app_notific_tipo_d7ec10_idx'), models.Index(fields=['fecha_creacion'], name='app_notific_fecha_c_1b58f8_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='grupobienes',
            index=models.Index(fields=['ramo'], name='app_grupobi_ramo_id_e0883c_idx'),
        ),
        migrations.AddIndex(
            model_name='grupobienes',
            index=models.Index(fields=['activo'], name='app_grupobi_activo_c1f2c1_idx'),
        ),
        migrations.AddIndex(
            model_name='detallepolizaramo',
            index=models.Index(fields=['poliza', 'ramo'], name='app_detalle_poliza__27968d_idx'),
        ),
    ]
