# Generated by Django 5.2.9 on 2026-01-23 12:44



import app.validators

import django.core.validators

import django.db.models.deletion

import simple_history.models

from decimal import Decimal

from django.conf import settings

from django.db import migrations, models





class Migration(migrations.Migration):



    initial = True



    dependencies = [

        migrations.swappable_dependency(settings.AUTH_USER_MODEL),

    ]



    operations = [

        migrations.CreateModel(

            name='ChecklistSiniestroConfig',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Item')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('es_obligatorio', models.BooleanField(default=True, verbose_name='Es Obligatorio')),

                ('orden', models.PositiveIntegerField(default=0, verbose_name='Orden')),

                ('activo', models.BooleanField(default=True, verbose_name='Activo')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

            ],

            options={

                'verbose_name': 'Configuración de Checklist de Siniestro',

                'verbose_name_plural': 'Configuraciones de Checklist de Siniestro',

                'ordering': ['tipo_siniestro', 'orden', 'nombre'],

            },

        ),

        migrations.CreateModel(

            name='CompaniaAseguradora',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('nombre', models.CharField(max_length=200, unique=True, verbose_name='Nombre de la Compañía')),

                ('ruc', models.CharField(max_length=13, unique=True, validators=[django.core.validators.RegexValidator(code='invalid_ruc', message='El RUC debe contener exactamente 13 dígitos numéricos.', regex='^\\d{13}$')], verbose_name='RUC')),

                ('direccion', models.TextField(blank=True, verbose_name='Dirección')),

                ('telefono', models.CharField(blank=True, max_length=20, verbose_name='Teléfono')),

                ('email', models.EmailField(blank=True, max_length=254, verbose_name='Email')),

                ('contacto_nombre', models.CharField(blank=True, max_length=200, verbose_name='Nombre del Contacto')),

                ('contacto_telefono', models.CharField(blank=True, max_length=20, verbose_name='Teléfono del Contacto')),

                ('activo', models.BooleanField(default=True, verbose_name='Activo')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

            ],

            options={

                'verbose_name': 'Compañía Aseguradora',

                'verbose_name_plural': 'Compañías Aseguradoras',

                'ordering': ['nombre'],

            },

        ),

        migrations.CreateModel(

            name='ConfiguracionSistema',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('clave', models.CharField(max_length=100, unique=True, verbose_name='Clave')),

                ('valor', models.TextField(verbose_name='Valor')),

                ('tipo', models.CharField(choices=[('decimal', 'Decimal'), ('entero', 'Entero'), ('texto', 'Texto'), ('json', 'JSON')], default='texto', max_length=20, verbose_name='Tipo')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('categoria', models.CharField(choices=[('facturas', 'Facturas y Pagos'), ('polizas', 'Pólizas'), ('siniestros', 'Siniestros'), ('general', 'General')], default='general', max_length=50, verbose_name='Categoría')),

            ],

            options={

                'verbose_name': 'Configuración del Sistema',

                'verbose_name_plural': 'Configuraciones del Sistema',

                'ordering': ['categoria', 'clave'],

            },

        ),

        migrations.CreateModel(

            name='GrupoRamo',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('codigo', models.CharField(max_length=50, verbose_name='Código')),

                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Grupo')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('activo', models.BooleanField(default=True, verbose_name='Activo')),

                ('es_predefinido', models.BooleanField(default=False, help_text='Los grupos predefinidos no pueden eliminarse', verbose_name='Es Predefinido')),

                ('orden', models.PositiveIntegerField(default=0, help_text='Orden de visualización', verbose_name='Orden')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

            ],

            options={

                'verbose_name': 'Grupo de Ramo',

                'verbose_name_plural': 'Grupos de Ramo',

                'ordering': ['tipo_ramo', 'orden', 'nombre'],

            },

        ),

        migrations.CreateModel(

            name='TipoPoliza',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('nombre', models.CharField(max_length=100, unique=True, verbose_name='Tipo de Póliza')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('activo', models.BooleanField(default=True, verbose_name='Activo')),

            ],

            options={

                'verbose_name': 'Tipo de Póliza',

                'verbose_name_plural': 'Tipos de Póliza',

                'ordering': ['nombre'],

            },

        ),

        migrations.CreateModel(

            name='TipoSiniestro',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('nombre', models.CharField(choices=[('daño', 'Daño'), ('robo', 'Robo'), ('hurto', 'Hurto'), ('incendio', 'Incendio'), ('inundacion', 'Inundación'), ('terremoto', 'Terremoto'), ('vandalismo', 'Vandalismo'), ('otro', 'Otro')], max_length=50, unique=True, verbose_name='Tipo de Siniestro')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('activo', models.BooleanField(default=True, verbose_name='Activo')),

            ],

            options={

                'verbose_name': 'Tipo de Siniestro',

                'verbose_name_plural': 'Tipos de Siniestro',

                'ordering': ['nombre'],

            },

        ),

        migrations.CreateModel(

            name='CorredorSeguros',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Corredor')),

                ('ruc', models.CharField(max_length=13, unique=True, validators=[django.core.validators.RegexValidator(code='invalid_ruc', message='El RUC debe contener exactamente 13 dígitos numéricos.', regex='^\\d{13}$')], verbose_name='RUC')),

                ('direccion', models.TextField(blank=True, verbose_name='Dirección')),

                ('telefono', models.CharField(blank=True, max_length=20, verbose_name='Teléfono')),

                ('email', models.EmailField(blank=True, max_length=254, verbose_name='Email')),

                ('contacto_nombre', models.CharField(blank=True, max_length=200, verbose_name='Nombre del Contacto')),

                ('contacto_telefono', models.CharField(blank=True, max_length=20, verbose_name='Teléfono del Contacto')),

                ('activo', models.BooleanField(default=True, verbose_name='Activo')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('compania_aseguradora', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='corredores', to='app.companiaaseguradora', verbose_name='Compañía Aseguradora')),

            ],

            options={

                'verbose_name': 'Corredor de Seguros',

                'verbose_name_plural': 'Corredores de Seguros',

                'ordering': ['compania_aseguradora__nombre', 'nombre'],

                'unique_together': {('compania_aseguradora', 'nombre')},

            },

        ),

        migrations.CreateModel(

            name='Factura',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('numero_factura', models.CharField(max_length=100, unique=True, verbose_name='Número de Factura')),

                ('fecha_emision', models.DateField(verbose_name='Fecha de Emisión')),

                ('fecha_vencimiento', models.DateField(verbose_name='Fecha de Vencimiento')),

                ('subtotal', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Subtotal')),

                ('iva', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='IVA')),

                ('contribucion_superintendencia', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Contribución Superintendencia (3.5%)')),

                ('contribucion_seguro_campesino', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Contribución Seguro Campesino (0.5%)')),

                ('retenciones', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Retenciones')),

                ('descuento_pronto_pago', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Descuento por Pronto Pago')),

                ('monto_total', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Monto Total')),

                ('estado', models.CharField(choices=[('pendiente', 'Pendiente'), ('pagada', 'Pagada'), ('parcial', 'Pago Parcial'), ('vencida', 'Vencida')], default='pendiente', max_length=20, verbose_name='Estado')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('creado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='facturas_creadas', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

            ],

            options={

                'verbose_name': 'Factura',

                'verbose_name_plural': 'Facturas',

                'ordering': ['-fecha_emision'],

            },

        ),

        migrations.CreateModel(

            name='HistoricalNotaCredito',

            fields=[

                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),

                ('numero', models.CharField(db_index=True, max_length=100, verbose_name='Número de Nota de Crédito')),

                ('fecha_emision', models.DateField(verbose_name='Fecha de Emisión')),

                ('monto', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Monto')),

                ('motivo', models.TextField(verbose_name='Motivo')),

                ('estado', models.CharField(choices=[('emitida', 'Emitida'), ('aplicada', 'Aplicada'), ('anulada', 'Anulada')], default='emitida', max_length=20, verbose_name='Estado')),

                ('documento', models.TextField(blank=True, max_length=100, null=True, verbose_name='Documento')),

                ('fecha_creacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),

                ('history_id', models.AutoField(primary_key=True, serialize=False)),

                ('history_date', models.DateTimeField(db_index=True)),

                ('history_change_reason', models.CharField(max_length=100, null=True)),

                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),

                ('creado_por', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('factura', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.factura', verbose_name='Factura')),

                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),

            ],

            options={

                'verbose_name': 'Historial',

                'verbose_name_plural': 'Historial de cambios',

                'ordering': ('-history_date', '-history_id'),

                'get_latest_by': ('history_date', 'history_id'),

            },

            bases=(simple_history.models.HistoricalChanges, models.Model),

        ),

        migrations.CreateModel(

            name='HistoricalPago',

            fields=[

                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),

                ('fecha_pago', models.DateField(verbose_name='Fecha de Pago')),

                ('monto', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Monto Pagado')),

                ('forma_pago', models.CharField(choices=[('transferencia', 'Transferencia Bancaria'), ('cheque', 'Cheque'), ('efectivo', 'Efectivo'), ('tarjeta', 'Tarjeta de Crédito')], max_length=20, verbose_name='Forma de Pago')),

                ('referencia', models.CharField(blank=True, max_length=200, verbose_name='Número de Referencia/Comprobante')),

                ('estado', models.CharField(choices=[('pendiente', 'Pendiente'), ('aprobado', 'Aprobado'), ('rechazado', 'Rechazado')], default='pendiente', max_length=20, verbose_name='Estado')),

                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),

                ('fecha_creacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),

                ('history_id', models.AutoField(primary_key=True, serialize=False)),

                ('history_date', models.DateTimeField(db_index=True)),

                ('history_change_reason', models.CharField(max_length=100, null=True)),

                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),

                ('factura', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.factura', verbose_name='Factura')),

                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),

                ('registrado_por', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Registrado por')),

            ],

            options={

                'verbose_name': 'Historial',

                'verbose_name_plural': 'Historial de cambios',

                'ordering': ('-history_date', '-history_id'),

                'get_latest_by': ('history_date', 'history_id'),

            },

            bases=(simple_history.models.HistoricalChanges, models.Model),

        ),

        migrations.CreateModel(

            name='NotaCredito',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('numero', models.CharField(max_length=100, unique=True, verbose_name='Número de Nota de Crédito')),

                ('fecha_emision', models.DateField(verbose_name='Fecha de Emisión')),

                ('monto', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Monto')),

                ('motivo', models.TextField(verbose_name='Motivo')),

                ('estado', models.CharField(choices=[('emitida', 'Emitida'), ('aplicada', 'Aplicada'), ('anulada', 'Anulada')], default='emitida', max_length=20, verbose_name='Estado')),

                ('documento', models.FileField(blank=True, null=True, upload_to='notas_credito/%Y/%m/', verbose_name='Documento')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('creado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='notas_credito_creadas', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('factura', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='notas_credito', to='app.factura', verbose_name='Factura')),

            ],

            options={

                'verbose_name': 'Nota de Crédito',

                'verbose_name_plural': 'Notas de Crédito',

                'ordering': ['-fecha_emision'],

            },

        ),

        migrations.CreateModel(

            name='Pago',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('fecha_pago', models.DateField(verbose_name='Fecha de Pago')),

                ('monto', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Monto Pagado')),

                ('forma_pago', models.CharField(choices=[('transferencia', 'Transferencia Bancaria'), ('cheque', 'Cheque'), ('efectivo', 'Efectivo'), ('tarjeta', 'Tarjeta de Crédito')], max_length=20, verbose_name='Forma de Pago')),

                ('referencia', models.CharField(blank=True, max_length=200, verbose_name='Número de Referencia/Comprobante')),

                ('estado', models.CharField(choices=[('pendiente', 'Pendiente'), ('aprobado', 'Aprobado'), ('rechazado', 'Rechazado')], default='pendiente', max_length=20, verbose_name='Estado')),

                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('factura', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='pagos', to='app.factura', verbose_name='Factura')),

                ('registrado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='pagos_registrados', to=settings.AUTH_USER_MODEL, verbose_name='Registrado por')),

            ],

            options={

                'verbose_name': 'Pago',

                'verbose_name_plural': 'Pagos',

                'ordering': ['-fecha_pago'],

            },

        ),

        migrations.CreateModel(

            name='Poliza',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('numero_poliza', models.CharField(max_length=100, unique=True, verbose_name='Número de Póliza')),

                ('suma_asegurada', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Suma Asegurada')),

                ('coberturas', models.TextField(verbose_name='Coberturas Detalladas')),

                ('prima_neta', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Costo base del seguro sin impuestos ni contribuciones', max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Prima Neta')),

                ('prima_total', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Prima neta + IVA + contribuciones', max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Prima Total')),

                ('deducible', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Monto que asume el asegurado en cada siniestro', max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Deducible')),

                ('porcentaje_deducible', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Porcentaje del siniestro que asume el asegurado (alternativo al monto fijo)', max_digits=5, validators=[django.core.validators.MinValueValidator(Decimal('0.00')), django.core.validators.MaxValueValidator(Decimal('100.00'))], verbose_name='% Deducible')),

                ('deducible_minimo', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Monto mínimo de deducible cuando se usa porcentaje', max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Deducible Mínimo')),

                ('fecha_inicio', models.DateField(verbose_name='Fecha de Inicio de Vigencia')),

                ('fecha_fin', models.DateField(verbose_name='Fecha de Fin de Vigencia')),

                ('estado', models.CharField(choices=[('vigente', 'Vigente'), ('vencida', 'Vencida'), ('cancelada', 'Cancelada'), ('por_vencer', 'Por Vencer')], default='vigente', max_length=20, verbose_name='Estado')),

                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),

                ('es_gran_contribuyente', models.BooleanField(default=False, help_text='Si está activo, se aplicarán retenciones de prima (1%) e IVA (100%)', verbose_name='Es Gran Contribuyente')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('compania_aseguradora', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='polizas', to='app.companiaaseguradora', verbose_name='Compañía Aseguradora')),

                ('corredor_seguros', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='polizas', to='app.corredorseguros', verbose_name='Corredor de Seguros')),

                ('creado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='polizas_creadas', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('grupo_ramo', models.ForeignKey(blank=True, help_text='Categoría de la póliza según clasificación de ramos', null=True, on_delete=django.db.models.deletion.PROTECT, related_name='polizas', to='app.gruporamo', verbose_name='Grupo de Ramo')),

                ('tipo_poliza', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='polizas', to='app.tipopoliza', verbose_name='Tipo de Póliza')),

            ],

            options={

                'verbose_name': 'Póliza',

                'verbose_name_plural': 'Pólizas',

                'ordering': ['-fecha_inicio'],

            },

        ),

        migrations.CreateModel(

            name='HistoricalFactura',

            fields=[

                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),

                ('numero_factura', models.CharField(db_index=True, max_length=100, verbose_name='Número de Factura')),

                ('fecha_emision', models.DateField(verbose_name='Fecha de Emisión')),

                ('fecha_vencimiento', models.DateField(verbose_name='Fecha de Vencimiento')),

                ('subtotal', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Subtotal')),

                ('iva', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='IVA')),

                ('contribucion_superintendencia', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Contribución Superintendencia (3.5%)')),

                ('contribucion_seguro_campesino', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Contribución Seguro Campesino (0.5%)')),

                ('retenciones', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Retenciones')),

                ('descuento_pronto_pago', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Descuento por Pronto Pago')),

                ('monto_total', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Monto Total')),

                ('estado', models.CharField(choices=[('pendiente', 'Pendiente'), ('pagada', 'Pagada'), ('parcial', 'Pago Parcial'), ('vencida', 'Vencida')], default='pendiente', max_length=20, verbose_name='Estado')),

                ('fecha_creacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),

                ('history_id', models.AutoField(primary_key=True, serialize=False)),

                ('history_date', models.DateTimeField(db_index=True)),

                ('history_change_reason', models.CharField(max_length=100, null=True)),

                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),

                ('creado_por', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),

                ('poliza', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.poliza', verbose_name='Póliza')),

            ],

            options={

                'verbose_name': 'Historial',

                'verbose_name_plural': 'Historial de cambios',

                'ordering': ('-history_date', '-history_id'),

                'get_latest_by': ('history_date', 'history_id'),

            },

            bases=(simple_history.models.HistoricalChanges, models.Model),

        ),

        migrations.AddField(

            model_name='factura',

            name='poliza',

            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='facturas', to='app.poliza', verbose_name='Póliza'),

        ),

        migrations.CreateModel(

            name='Quote',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('quote_number', models.CharField(max_length=100, unique=True, verbose_name='Número de Cotización')),

                ('title', models.CharField(max_length=200, verbose_name='Título/Descripción')),

                ('sum_insured', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Suma a Asegurar')),

                ('coverage_details', models.TextField(verbose_name='Detalle de Coberturas Solicitadas')),

                ('request_date', models.DateField(verbose_name='Fecha de Solicitud')),

                ('valid_until', models.DateField(verbose_name='Válida Hasta')),

                ('desired_start_date', models.DateField(verbose_name='Fecha de Inicio Deseada')),

                ('desired_end_date', models.DateField(verbose_name='Fecha de Fin Deseada')),

                ('status', models.CharField(choices=[('draft', 'Borrador'), ('sent', 'Enviada'), ('under_review', 'En Revisión'), ('accepted', 'Aceptada'), ('rejected', 'Rechazada'), ('expired', 'Expirada'), ('converted', 'Convertida a Póliza')], default='draft', max_length=20, verbose_name='Estado')),

                ('priority', models.CharField(choices=[('low', 'Baja'), ('medium', 'Media'), ('high', 'Alta'), ('urgent', 'Urgente')], default='medium', max_length=20, verbose_name='Prioridad')),

                ('notes', models.TextField(blank=True, verbose_name='Notas Internas')),

                ('rejection_reason', models.TextField(blank=True, verbose_name='Motivo de Rechazo')),

                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('requested_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='quotes_requested', to=settings.AUTH_USER_MODEL, verbose_name='Solicitado por')),

                ('resulting_policy', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='source_quote', to='app.poliza', verbose_name='Póliza Resultante')),

                ('policy_type', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='quotes', to='app.tipopoliza', verbose_name='Tipo de Póliza')),

            ],

            options={

                'verbose_name': 'Cotización',

                'verbose_name_plural': 'Cotizaciones',

                'ordering': ['-request_date'],

            },

        ),

        migrations.CreateModel(

            name='PolicyRenewal',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('renewal_number', models.CharField(max_length=100, unique=True, verbose_name='Número de Renovación')),

                ('notification_date', models.DateField(verbose_name='Fecha de Notificación')),

                ('due_date', models.DateField(verbose_name='Fecha Límite de Renovación')),

                ('decision_date', models.DateField(blank=True, null=True, verbose_name='Fecha de Decisión')),

                ('completion_date', models.DateField(blank=True, null=True, verbose_name='Fecha de Completado')),

                ('original_premium', models.DecimalField(decimal_places=2, max_digits=15, verbose_name='Prima Original')),

                ('proposed_premium', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Prima Propuesta')),

                ('final_premium', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Prima Final')),

                ('coverage_changes', models.TextField(blank=True, verbose_name='Cambios en Coberturas')),

                ('status', models.CharField(choices=[('pending', 'Pendiente'), ('in_progress', 'En Proceso'), ('quoted', 'Cotizada'), ('approved', 'Aprobada'), ('rejected', 'Rechazada'), ('completed', 'Completada'), ('cancelled', 'Cancelada')], default='pending', max_length=20, verbose_name='Estado')),

                ('decision', models.CharField(choices=[('renew_same', 'Renovar con Misma Aseguradora'), ('renew_different', 'Renovar con Otra Aseguradora'), ('not_renew', 'No Renovar'), ('pending', 'Pendiente de Decisión')], default='pending', max_length=20, verbose_name='Decisión')),

                ('decision_reason', models.TextField(blank=True, verbose_name='Justificación de Decisión')),

                ('reminder_sent', models.BooleanField(default=False, verbose_name='Recordatorio Enviado')),

                ('reminder_date', models.DateField(blank=True, null=True, verbose_name='Fecha de Recordatorio')),

                ('notes', models.TextField(blank=True, verbose_name='Notas')),

                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='renewals_approved', to=settings.AUTH_USER_MODEL, verbose_name='Aprobado por')),

                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='renewals_created', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('new_policy', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='renewal_source', to='app.poliza', verbose_name='Nueva Póliza')),

                ('original_policy', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='renewals', to='app.poliza', verbose_name='Póliza Original')),

                ('quote', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='renewals', to='app.quote', verbose_name='Cotización Asociada')),

            ],

            options={

                'verbose_name': 'Renovación de Póliza',

                'verbose_name_plural': 'Renovaciones de Pólizas',

                'ordering': ['-due_date'],

            },

        ),

        migrations.CreateModel(

            name='HistoricalPolicyRenewal',

            fields=[

                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),

                ('renewal_number', models.CharField(db_index=True, max_length=100, verbose_name='Número de Renovación')),

                ('notification_date', models.DateField(verbose_name='Fecha de Notificación')),

                ('due_date', models.DateField(verbose_name='Fecha Límite de Renovación')),

                ('decision_date', models.DateField(blank=True, null=True, verbose_name='Fecha de Decisión')),

                ('completion_date', models.DateField(blank=True, null=True, verbose_name='Fecha de Completado')),

                ('original_premium', models.DecimalField(decimal_places=2, max_digits=15, verbose_name='Prima Original')),

                ('proposed_premium', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Prima Propuesta')),

                ('final_premium', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Prima Final')),

                ('coverage_changes', models.TextField(blank=True, verbose_name='Cambios en Coberturas')),

                ('status', models.CharField(choices=[('pending', 'Pendiente'), ('in_progress', 'En Proceso'), ('quoted', 'Cotizada'), ('approved', 'Aprobada'), ('rejected', 'Rechazada'), ('completed', 'Completada'), ('cancelled', 'Cancelada')], default='pending', max_length=20, verbose_name='Estado')),

                ('decision', models.CharField(choices=[('renew_same', 'Renovar con Misma Aseguradora'), ('renew_different', 'Renovar con Otra Aseguradora'), ('not_renew', 'No Renovar'), ('pending', 'Pendiente de Decisión')], default='pending', max_length=20, verbose_name='Decisión')),

                ('decision_reason', models.TextField(blank=True, verbose_name='Justificación de Decisión')),

                ('reminder_sent', models.BooleanField(default=False, verbose_name='Recordatorio Enviado')),

                ('reminder_date', models.DateField(blank=True, null=True, verbose_name='Fecha de Recordatorio')),

                ('notes', models.TextField(blank=True, verbose_name='Notas')),

                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),

                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),

                ('history_id', models.AutoField(primary_key=True, serialize=False)),

                ('history_date', models.DateTimeField(db_index=True)),

                ('history_change_reason', models.CharField(max_length=100, null=True)),

                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),

                ('approved_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Aprobado por')),

                ('created_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),

                ('new_policy', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.poliza', verbose_name='Nueva Póliza')),

                ('original_policy', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.poliza', verbose_name='Póliza Original')),

                ('quote', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.quote', verbose_name='Cotización Asociada')),

            ],

            options={

                'verbose_name': 'Historial',

                'verbose_name_plural': 'Historial de cambios',

                'ordering': ('-history_date', '-history_id'),

                'get_latest_by': ('history_date', 'history_id'),

            },

            bases=(simple_history.models.HistoricalChanges, models.Model),

        ),

        migrations.CreateModel(

            name='QuoteOption',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('premium_amount', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Prima Anual')),

                ('deductible', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Deducible')),

                ('coverage_offered', models.TextField(verbose_name='Coberturas Ofrecidas')),

                ('exclusions', models.TextField(blank=True, verbose_name='Exclusiones')),

                ('conditions', models.TextField(blank=True, verbose_name='Condiciones Especiales')),

                ('proposal_document', models.FileField(blank=True, null=True, upload_to='quotes/proposals/%Y/%m/', verbose_name='Documento de Propuesta')),

                ('is_recommended', models.BooleanField(default=False, verbose_name='Recomendada')),

                ('rating', models.PositiveSmallIntegerField(blank=True, null=True, validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)], verbose_name='Calificación (1-5)')),

                ('evaluation_notes', models.TextField(blank=True, verbose_name='Notas de Evaluación')),

                ('received_date', models.DateField(verbose_name='Fecha de Recepción')),

                ('valid_until', models.DateField(verbose_name='Válida Hasta')),

                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('broker', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='quote_options', to='app.corredorseguros', verbose_name='Corredor')),

                ('insurer', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='quote_options', to='app.companiaaseguradora', verbose_name='Aseguradora')),

                ('quote', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='options', to='app.quote', verbose_name='Cotización')),

            ],

            options={

                'verbose_name': 'Opción de Cotización',

                'verbose_name_plural': 'Opciones de Cotización',

                'ordering': ['premium_amount'],

            },

        ),

        migrations.CreateModel(

            name='ResponsableCustodio',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('nombre', models.CharField(max_length=200, verbose_name='Nombre Completo')),

                ('cargo', models.CharField(blank=True, max_length=200, verbose_name='Cargo')),

                ('departamento', models.CharField(blank=True, max_length=200, verbose_name='Departamento/Área')),

                ('email', models.EmailField(blank=True, max_length=254, verbose_name='Email')),

                ('telefono', models.CharField(blank=True, max_length=20, verbose_name='Teléfono')),

                ('activo', models.BooleanField(default=True, verbose_name='Activo')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

            ],

            options={

                'verbose_name': 'Responsable/Custodio',

                'verbose_name_plural': 'Responsables/Custodios',

                'ordering': ['nombre'],

                'indexes': [models.Index(fields=['nombre'], name='app_respons_nombre_000e3b_idx')],

            },

        ),

        migrations.CreateModel(

            name='GrupoBienes',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Grupo')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('activo', models.BooleanField(default=True, verbose_name='Activo')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('creado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='grupos_bienes_creados', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('grupo_ramo', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='grupos_bienes', to='app.gruporamo', verbose_name='Grupo de Ramo')),

                ('poliza', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='grupos_bienes', to='app.poliza', verbose_name='Póliza')),

                ('responsable', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='grupos_bienes', to='app.responsablecustodio', verbose_name='Responsable')),

            ],

            options={

                'verbose_name': 'Grupo de Bienes',

                'verbose_name_plural': 'Grupos de Bienes',

                'ordering': ['nombre'],

            },

        ),

        migrations.CreateModel(

            name='BienAsegurado',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('codigo_bien', models.CharField(help_text='Identificador único del bien asegurado', max_length=100, unique=True, verbose_name='Código del Bien')),

                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Bien')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('categoria', models.CharField(blank=True, help_text='Categoría del bien (ej: Equipos de Cómputo, Vehículos)', max_length=100, verbose_name='Categoría')),

                ('marca', models.CharField(blank=True, max_length=100, verbose_name='Marca')),

                ('modelo', models.CharField(blank=True, max_length=100, verbose_name='Modelo')),

                ('serie', models.CharField(blank=True, max_length=100, verbose_name='Número de Serie')),

                ('codigo_activo', models.CharField(blank=True, help_text='Código institucional del activo fijo', max_length=100, verbose_name='Código de Activo Fijo')),

                ('anio_fabricacion', models.PositiveIntegerField(blank=True, null=True, verbose_name='Año de Fabricación')),

                ('ubicacion', models.CharField(blank=True, max_length=300, verbose_name='Ubicación General')),

                ('edificio', models.CharField(blank=True, max_length=100, verbose_name='Edificio')),

                ('piso', models.CharField(blank=True, max_length=50, verbose_name='Piso')),

                ('departamento', models.CharField(blank=True, max_length=100, verbose_name='Departamento/Área')),

                ('valor_compra', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Valor de Compra')),

                ('valor_actual', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Valor Actual (Depreciado)')),

                ('valor_asegurado', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Valor Asegurado')),

                ('valor_comercial', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Valor Comercial')),

                ('estado', models.CharField(choices=[('activo', 'Activo'), ('inactivo', 'Inactivo'), ('dado_de_baja', 'Dado de Baja'), ('siniestrado', 'Siniestrado'), ('transferido', 'Transferido')], default='activo', max_length=20, verbose_name='Estado')),

                ('condicion', models.CharField(choices=[('excelente', 'Excelente'), ('bueno', 'Bueno'), ('regular', 'Regular'), ('malo', 'Malo')], default='bueno', max_length=20, verbose_name='Condición Física')),

                ('fecha_adquisicion', models.DateField(blank=True, null=True, verbose_name='Fecha de Adquisición')),

                ('fecha_garantia', models.DateField(blank=True, null=True, verbose_name='Vencimiento de Garantía')),

                ('imagen', models.ImageField(blank=True, null=True, upload_to='bienes/imagenes/%Y/%m/', verbose_name='Imagen del Bien')),

                ('codigo_qr', models.CharField(blank=True, help_text='Código QR para identificación rápida', max_length=200, verbose_name='Código QR')),

                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),

                ('activo', models.BooleanField(default=True, verbose_name='Activo')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('creado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='bienes_creados', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('grupo_bienes', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='bienes_asegurados', to='app.grupobienes', verbose_name='Grupo de Bienes')),

                ('poliza', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='bienes_asegurados', to='app.poliza', verbose_name='Póliza')),

                ('responsable_custodio', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='bienes_asegurados', to='app.responsablecustodio', verbose_name='Responsable/Custodio')),

            ],

            options={

                'verbose_name': 'Bien Asegurado',

                'verbose_name_plural': 'Bienes Asegurados',

                'ordering': ['poliza', 'nombre'],

            },

        ),

        migrations.CreateModel(

            name='Siniestro',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('numero_siniestro', models.CharField(max_length=100, unique=True, verbose_name='Número de Siniestro')),

                ('fecha_siniestro', models.DateTimeField(verbose_name='Fecha y Hora del Siniestro')),

                ('fecha_registro', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Registro')),

                ('bien_nombre', models.CharField(blank=True, default='', help_text='Campo legacy: usar bien_asegurado en su lugar', max_length=200, verbose_name='Nombre del Bien')),

                ('bien_modelo', models.CharField(blank=True, max_length=100, verbose_name='Modelo')),

                ('bien_serie', models.CharField(blank=True, max_length=100, verbose_name='Número de Serie')),

                ('bien_marca', models.CharField(blank=True, max_length=100, verbose_name='Marca')),

                ('bien_codigo_activo', models.CharField(blank=True, max_length=100, verbose_name='Código de Activo')),

                ('ubicacion', models.CharField(max_length=300, verbose_name='Ubicación del Siniestro')),

                ('causa', models.TextField(verbose_name='Causa del Siniestro')),

                ('descripcion_detallada', models.TextField(verbose_name='Descripción Detallada')),

                ('monto_estimado', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Monto Estimado del Daño')),

                ('monto_indemnizado', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Monto Indemnizado')),

                ('valor_reclamo', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Valor del Reclamo (según proforma)')),

                ('deducible_aplicado', models.DecimalField(blank=True, decimal_places=2, help_text='Deducible efectivamente aplicado en este siniestro (calculado desde la póliza)', max_digits=15, null=True, verbose_name='Deducible Aplicado')),

                ('depreciacion', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Depreciación')),

                ('suma_asegurada_bien', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Suma Asegurada del Bien')),

                ('email_broker', models.EmailField(blank=True, help_text='Email específico para este siniestro', max_length=254, verbose_name='Email del Broker')),

                ('estado', models.CharField(choices=[('registrado', 'Registrado'), ('documentacion_pendiente', 'Documentación Pendiente'), ('enviado_aseguradora', 'Enviado a Aseguradora'), ('en_evaluacion', 'En Evaluación'), ('aprobado', 'Aprobado'), ('rechazado', 'Rechazado'), ('liquidado', 'Liquidado'), ('cerrado', 'Cerrado')], default='registrado', max_length=30, verbose_name='Estado')),

                ('fecha_envio_aseguradora', models.DateField(blank=True, null=True, verbose_name='Fecha de Envío a Aseguradora')),

                ('fecha_respuesta_aseguradora', models.DateField(blank=True, null=True, verbose_name='Fecha de Respuesta de Aseguradora')),

                ('fecha_liquidacion', models.DateField(blank=True, null=True, verbose_name='Fecha de Liquidación')),

                ('fecha_notificacion_broker', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Notificación al Broker')),

                ('fecha_respuesta_esperada', models.DateField(blank=True, null=True, verbose_name='Fecha de Respuesta Esperada (5 días hábiles)')),

                ('fecha_notificacion_responsable', models.DateField(blank=True, null=True, verbose_name='Fecha de Notificación al Responsable')),

                ('fecha_firma_indemnizacion', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Firma del Recibo de Indemnización')),

                ('fecha_limite_deposito', models.DateField(blank=True, null=True, verbose_name='Fecha Límite de Depósito (72h)')),

                ('valor_pagado', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Valor Pagado')),

                ('fecha_pago', models.DateField(blank=True, null=True, verbose_name='Fecha de Pago')),

                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('bien_asegurado', models.ForeignKey(blank=True, help_text='Bien específico afectado por el siniestro', null=True, on_delete=django.db.models.deletion.PROTECT, related_name='siniestros', to='app.bienasegurado', verbose_name='Bien Asegurado')),

                ('creado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='siniestros_creados', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('poliza', models.ForeignKey(blank=True, help_text='Póliza asociada (se obtiene automáticamente del bien asegurado)', null=True, on_delete=django.db.models.deletion.PROTECT, related_name='siniestros', to='app.poliza', verbose_name='Póliza')),

                ('responsable_custodio', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.PROTECT, related_name='siniestros', to='app.responsablecustodio', verbose_name='Responsable/Custodio')),

                ('tipo_siniestro', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='siniestros', to='app.tiposiniestro', verbose_name='Tipo de Siniestro')),

            ],

            options={

                'verbose_name': 'Siniestro',

                'verbose_name_plural': 'Siniestros',

                'ordering': ['-fecha_siniestro'],

            },

        ),

        migrations.CreateModel(

            name='NotificacionEmail',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('tipo', models.CharField(choices=[('siniestro_broker', 'Siniestro a Broker'), ('siniestro_responsable', 'Siniestro a Responsable'), ('siniestro_cierre', 'Cierre de Siniestro'), ('alerta_respuesta', 'Alerta de Respuesta Pendiente'), ('alerta_deposito', 'Alerta de Depósito Pendiente'), ('poliza_vencimiento', 'Vencimiento de Póliza'), ('factura_vencimiento', 'Vencimiento de Factura'), ('renovacion_pendiente', 'Renovación Pendiente'), ('otro', 'Otro')], max_length=30, verbose_name='Tipo de Notificación')),

                ('destinatario', models.EmailField(max_length=254, verbose_name='Destinatario')),

                ('cc', models.TextField(blank=True, verbose_name='CC (separados por coma)')),

                ('asunto', models.CharField(max_length=300, verbose_name='Asunto')),

                ('contenido', models.TextField(verbose_name='Contenido del Email')),

                ('contenido_html', models.TextField(blank=True, verbose_name='Contenido HTML')),

                ('estado', models.CharField(choices=[('pendiente', 'Pendiente'), ('enviado', 'Enviado'), ('fallido', 'Fallido'), ('rebotado', 'Rebotado')], default='pendiente', max_length=20, verbose_name='Estado')),

                ('enviado', models.BooleanField(default=False, verbose_name='Enviado')),

                ('fecha_envio', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Envío')),

                ('intentos', models.PositiveIntegerField(default=0, verbose_name='Intentos de Envío')),

                ('error_mensaje', models.TextField(blank=True, verbose_name='Mensaje de Error')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('creado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='notificaciones_creadas', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('factura', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='notificaciones_email', to='app.factura', verbose_name='Factura')),

                ('poliza', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='notificaciones_email', to='app.poliza', verbose_name='Póliza')),

                ('siniestro', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='notificaciones_email', to='app.siniestro', verbose_name='Siniestro')),

            ],

            options={

                'verbose_name': 'Notificación de Email',

                'verbose_name_plural': 'Notificaciones de Email',

                'ordering': ['-fecha_creacion'],

            },

        ),

        migrations.CreateModel(

            name='HistoricalDocumento',

            fields=[

                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),

                ('tipo_documento', models.CharField(choices=[('poliza', 'Póliza de Seguro'), ('factura', 'Factura'), ('comprobante_pago', 'Comprobante de Pago'), ('informe_tecnico', 'Informe Técnico'), ('denuncia', 'Denuncia'), ('proforma', 'Proforma'), ('carta_formal', 'Carta Formal'), ('fotografia', 'Fotografía'), ('otro', 'Otro')], max_length=30, verbose_name='Tipo de Documento')),

                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Documento')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('fecha_subida', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Subida')),

                ('history_id', models.AutoField(primary_key=True, serialize=False)),

                ('history_date', models.DateTimeField(db_index=True)),

                ('history_change_reason', models.CharField(max_length=100, null=True)),

                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),

                ('factura', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.factura', verbose_name='Factura')),

                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),

                ('subido_por', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Subido por')),

                ('poliza', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.poliza', verbose_name='Póliza')),

                ('siniestro', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.siniestro', verbose_name='Siniestro')),

            ],

            options={

                'verbose_name': 'Historial',

                'verbose_name_plural': 'Historial de cambios',

                'ordering': ('-history_date', '-history_id'),

                'get_latest_by': ('history_date', 'history_id'),

            },

            bases=(simple_history.models.HistoricalChanges, models.Model),

        ),

        migrations.CreateModel(

            name='Documento',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('tipo_documento', models.CharField(choices=[('poliza', 'Póliza de Seguro'), ('factura', 'Factura'), ('comprobante_pago', 'Comprobante de Pago'), ('informe_tecnico', 'Informe Técnico'), ('denuncia', 'Denuncia'), ('proforma', 'Proforma'), ('carta_formal', 'Carta Formal'), ('fotografia', 'Fotografía'), ('otro', 'Otro')], max_length=30, verbose_name='Tipo de Documento')),

                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Documento')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('archivo', models.FileField(help_text='Archivos permitidos: PDF, imágenes (JPG, PNG), documentos Office. Máximo 10MB.', upload_to='documentos/%Y/%m/', validators=[app.validators.FileValidator()], verbose_name='Archivo')),

                ('fecha_subida', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Subida')),

                ('subido_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='documentos_subidos', to=settings.AUTH_USER_MODEL, verbose_name='Subido por')),

                ('factura', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='documentos', to='app.factura', verbose_name='Factura')),

                ('poliza', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='documentos', to='app.poliza', verbose_name='Póliza')),

                ('siniestro', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='documentos', to='app.siniestro', verbose_name='Siniestro')),

            ],

            options={

                'verbose_name': 'Documento',

                'verbose_name_plural': 'Documentos',

                'ordering': ['-fecha_subida'],

            },

        ),

        migrations.CreateModel(

            name='ChecklistSiniestro',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('completado', models.BooleanField(default=False, verbose_name='Completado')),

                ('fecha_completado', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Completado')),

                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('completado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='checklist_completados', to=settings.AUTH_USER_MODEL, verbose_name='Completado por')),

                ('config_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='instancias', to='app.checklistsiniestroconfig', verbose_name='Item de Checklist')),

                ('siniestro', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='checklist_items', to='app.siniestro', verbose_name='Siniestro')),

            ],

            options={

                'verbose_name': 'Item de Checklist de Siniestro',

                'verbose_name_plural': 'Items de Checklist de Siniestro',

                'ordering': ['siniestro', 'config_item__orden'],

            },

        ),

        migrations.CreateModel(

            name='CalendarEvent',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('title', models.CharField(max_length=200, verbose_name='Título')),

                ('description', models.TextField(blank=True, verbose_name='Descripción')),

                ('event_type', models.CharField(choices=[('policy_expiry', 'Vencimiento de Póliza'), ('invoice_due', 'Vencimiento de Factura'), ('renewal_due', 'Fecha Límite de Renovación'), ('claim_deadline', 'Plazo de Siniestro'), ('quote_expiry', 'Expiración de Cotización'), ('meeting', 'Reunión'), ('reminder', 'Recordatorio'), ('other', 'Otro')], max_length=30, verbose_name='Tipo de Evento')),

                ('priority', models.CharField(choices=[('low', 'Baja'), ('medium', 'Media'), ('high', 'Alta'), ('critical', 'Crítica')], default='medium', max_length=20, verbose_name='Prioridad')),

                ('start_date', models.DateField(verbose_name='Fecha de Inicio')),

                ('end_date', models.DateField(blank=True, null=True, verbose_name='Fecha de Fin')),

                ('all_day', models.BooleanField(default=True, verbose_name='Todo el Día')),

                ('start_time', models.TimeField(blank=True, null=True, verbose_name='Hora de Inicio')),

                ('end_time', models.TimeField(blank=True, null=True, verbose_name='Hora de Fin')),

                ('reminder_days', models.PositiveIntegerField(default=7, verbose_name='Días de Anticipación para Recordatorio')),

                ('reminder_sent', models.BooleanField(default=False, verbose_name='Recordatorio Enviado')),

                ('is_completed', models.BooleanField(default=False, verbose_name='Completado')),

                ('is_auto_generated', models.BooleanField(default=False, verbose_name='Generado Automáticamente')),

                ('created_at', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('updated_at', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='calendar_events_created', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('invoice', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='calendar_events', to='app.factura', verbose_name='Factura')),

                ('renewal', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='calendar_events', to='app.policyrenewal', verbose_name='Renovación')),

                ('policy', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='calendar_events', to='app.poliza', verbose_name='Póliza')),

                ('quote', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='calendar_events', to='app.quote', verbose_name='Cotización')),

                ('claim', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='calendar_events', to='app.siniestro', verbose_name='Siniestro')),

            ],

            options={

                'verbose_name': 'Evento de Calendario',

                'verbose_name_plural': 'Eventos de Calendario',

                'ordering': ['start_date', 'start_time'],

            },

        ),

        migrations.CreateModel(

            name='Alerta',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('tipo_alerta', models.CharField(choices=[('vencimiento_poliza', 'Vencimiento de Póliza'), ('pago_pendiente', 'Pago Pendiente'), ('documentacion_pendiente', 'Documentación Pendiente'), ('respuesta_aseguradora', 'Respuesta de Aseguradora Pendiente'), ('pronto_pago', 'Descuento por Pronto Pago Disponible')], max_length=30, verbose_name='Tipo de Alerta')),

                ('titulo', models.CharField(max_length=200, verbose_name='Título')),

                ('mensaje', models.TextField(verbose_name='Mensaje')),

                ('estado', models.CharField(choices=[('pendiente', 'Pendiente'), ('enviada', 'Enviada'), ('leida', 'Leída'), ('atendida', 'Atendida')], default='pendiente', max_length=20, verbose_name='Estado')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_envio', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Envío')),

                ('fecha_lectura', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Lectura')),

                ('destinatarios', models.ManyToManyField(related_name='alertas_recibidas', to=settings.AUTH_USER_MODEL, verbose_name='Destinatarios')),

                ('factura', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='alertas', to='app.factura', verbose_name='Factura')),

                ('poliza', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='alertas', to='app.poliza', verbose_name='Póliza')),

                ('siniestro', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='alertas', to='app.siniestro', verbose_name='Siniestro')),

            ],

            options={

                'verbose_name': 'Alerta',

                'verbose_name_plural': 'Alertas',

                'ordering': ['-fecha_creacion'],

            },

        ),

        migrations.CreateModel(

            name='AdjuntoSiniestro',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('tipo_adjunto', models.CharField(choices=[('informe', 'Informe'), ('proforma', 'Proforma'), ('salvamento', 'Acta de Salvamento'), ('preexistencia', 'Certificado de Preexistencia'), ('carta_formal', 'Carta Formal'), ('recibo_indemnizacion', 'Recibo de Indemnización'), ('fotos', 'Fotografías'), ('peritaje', 'Informe de Peritaje'), ('policia', 'Denuncia/Parte Policial'), ('otro', 'Otro')], max_length=30, verbose_name='Tipo de Adjunto')),

                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Documento')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('archivo', models.FileField(upload_to='siniestros/adjuntos/%Y/%m/', validators=[app.validators.FileValidator()], verbose_name='Archivo')),

                ('requiere_firma', models.BooleanField(default=False, verbose_name='Requiere Firma')),

                ('firmado', models.BooleanField(default=False, verbose_name='Firmado')),

                ('hash_firma', models.CharField(blank=True, max_length=64, verbose_name='Hash de Firma (SHA256)')),

                ('fecha_firma', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Firma')),

                ('ip_firma', models.GenericIPAddressField(blank=True, null=True, verbose_name='IP de Firma')),

                ('fecha_subida', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Subida')),

                ('firmado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='documentos_firmados', to=settings.AUTH_USER_MODEL, verbose_name='Firmado por')),

                ('subido_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='adjuntos_siniestro_subidos', to=settings.AUTH_USER_MODEL, verbose_name='Subido por')),

                ('checklist_item', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='adjuntos_vinculados', to='app.checklistsiniestro', verbose_name='Item del Checklist')),

                ('siniestro', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='adjuntos', to='app.siniestro', verbose_name='Siniestro')),

            ],

            options={

                'verbose_name': 'Adjunto de Siniestro',

                'verbose_name_plural': 'Adjuntos de Siniestro',

                'ordering': ['siniestro', 'tipo_adjunto', '-fecha_subida'],

            },

        ),

        migrations.CreateModel(

            name='SiniestroEmail',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('email_id', models.CharField(max_length=100, verbose_name='ID del Correo')),

                ('email_subject', models.CharField(max_length=500, verbose_name='Asunto del Correo')),

                ('email_from', models.CharField(max_length=300, verbose_name='Remitente')),

                ('email_date', models.DateTimeField(blank=True, null=True, verbose_name='Fecha del Correo')),

                ('email_body', models.TextField(blank=True, verbose_name='Cuerpo del Correo')),

                ('responsable_nombre', models.CharField(max_length=300, verbose_name='Nombre del Responsable')),

                ('fecha_reporte', models.CharField(max_length=50, verbose_name='Fecha de Reporte (texto)')),

                ('problema', models.TextField(verbose_name='Descripción del Problema')),

                ('causa', models.TextField(verbose_name='Causa del Daño')),

                ('periferico', models.CharField(max_length=200, verbose_name='Tipo de Periférico')),

                ('marca', models.CharField(max_length=200, verbose_name='Marca')),

                ('modelo', models.CharField(max_length=200, verbose_name='Modelo')),

                ('serie', models.CharField(max_length=200, verbose_name='Número de Serie')),

                ('codigo_activo', models.CharField(blank=True, max_length=200, verbose_name='Código de Activo')),

                ('estado_procesamiento', models.CharField(choices=[('pendiente', 'Pendiente de Revisión'), ('procesado', 'Procesado - Siniestro Creado'), ('error', 'Error en Procesamiento'), ('descartado', 'Descartado')], default='pendiente', max_length=20, verbose_name='Estado de Procesamiento')),

                ('mensaje_procesamiento', models.TextField(blank=True, verbose_name='Mensaje de Procesamiento')),

                ('fecha_recepcion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Recepción')),

                ('fecha_procesamiento', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Procesamiento')),

                ('activo_encontrado', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='siniestros_email', to='app.bienasegurado', verbose_name='Activo Encontrado')),

                ('procesado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='siniestros_email_procesados', to=settings.AUTH_USER_MODEL, verbose_name='Procesado por')),

                ('responsable_encontrado', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='siniestros_email', to='app.responsablecustodio', verbose_name='Responsable Encontrado')),

                ('siniestro_creado', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='origen_email', to='app.siniestro', verbose_name='Siniestro Creado')),

            ],

            options={

                'verbose_name': 'Siniestro por Email',

                'verbose_name_plural': 'Siniestros por Email',

                'ordering': ['-fecha_recepcion'],

            },

        ),

        migrations.CreateModel(

            name='SubgrupoRamo',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('codigo', models.CharField(max_length=50, verbose_name='Código')),

                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Subgrupo')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('activo', models.BooleanField(default=True, verbose_name='Activo')),

                ('es_predefinido', models.BooleanField(default=False, help_text='Los subgrupos predefinidos no pueden eliminarse', verbose_name='Es Predefinido')),

                ('orden', models.PositiveIntegerField(default=0, help_text='Orden de visualización', verbose_name='Orden')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('grupo_ramo', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='subgrupos', to='app.gruporamo', verbose_name='Grupo de Ramo')),

            ],

            options={

                'verbose_name': 'Subgrupo de Ramo',

                'verbose_name_plural': 'Subgrupos de Ramo',

                'ordering': ['grupo_ramo', 'orden', 'nombre'],

            },

        ),

        migrations.CreateModel(

            name='HistoricalDetallePolizaRamo',

            fields=[

                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),

                ('numero_factura', models.CharField(blank=True, max_length=100, verbose_name='N° Factura')),

                ('documento_contable', models.CharField(blank=True, max_length=100, verbose_name='Doc. Contable')),

                ('suma_asegurada', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Suma Asegurada')),

                ('total_prima', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Prima Total')),

                ('contribucion_superintendencia', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Contribución Superintendencia (3.5%)')),

                ('emision', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Emisión')),

                ('seguro_campesino', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Seguro Campesino (0.5%)')),

                ('base_imponible', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Base Imponible')),

                ('iva', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='IVA (15%)')),

                ('total_facturado', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Total Facturado')),

                ('retencion_prima', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Retención Prima (1%)')),

                ('retencion_iva', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Retención IVA (100%)')),

                ('valor_por_pagar', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Valor por Pagar')),

                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),

                ('fecha_creacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),

                ('history_id', models.AutoField(primary_key=True, serialize=False)),

                ('history_date', models.DateTimeField(db_index=True)),

                ('history_change_reason', models.CharField(max_length=100, null=True)),

                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),

                ('grupo_ramo', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.gruporamo', verbose_name='Grupo de Ramo')),

                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),

                ('poliza', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.poliza', verbose_name='Póliza')),

                ('subgrupo_ramo', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.subgruporamo', verbose_name='Subgrupo de Ramo')),

            ],

            options={

                'verbose_name': 'Historial',

                'verbose_name_plural': 'Historial de cambios',

                'ordering': ('-history_date', '-history_id'),

                'get_latest_by': ('history_date', 'history_id'),

            },

            bases=(simple_history.models.HistoricalChanges, models.Model),

        ),

        migrations.CreateModel(

            name='HistoricalBienAsegurado',

            fields=[

                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),

                ('codigo_bien', models.CharField(db_index=True, help_text='Identificador único del bien asegurado', max_length=100, verbose_name='Código del Bien')),

                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Bien')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('categoria', models.CharField(blank=True, help_text='Categoría del bien (ej: Equipos de Cómputo, Vehículos)', max_length=100, verbose_name='Categoría')),

                ('marca', models.CharField(blank=True, max_length=100, verbose_name='Marca')),

                ('modelo', models.CharField(blank=True, max_length=100, verbose_name='Modelo')),

                ('serie', models.CharField(blank=True, max_length=100, verbose_name='Número de Serie')),

                ('codigo_activo', models.CharField(blank=True, help_text='Código institucional del activo fijo', max_length=100, verbose_name='Código de Activo Fijo')),

                ('anio_fabricacion', models.PositiveIntegerField(blank=True, null=True, verbose_name='Año de Fabricación')),

                ('ubicacion', models.CharField(blank=True, max_length=300, verbose_name='Ubicación General')),

                ('edificio', models.CharField(blank=True, max_length=100, verbose_name='Edificio')),

                ('piso', models.CharField(blank=True, max_length=50, verbose_name='Piso')),

                ('departamento', models.CharField(blank=True, max_length=100, verbose_name='Departamento/Área')),

                ('valor_compra', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Valor de Compra')),

                ('valor_actual', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Valor Actual (Depreciado)')),

                ('valor_asegurado', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Valor Asegurado')),

                ('valor_comercial', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Valor Comercial')),

                ('estado', models.CharField(choices=[('activo', 'Activo'), ('inactivo', 'Inactivo'), ('dado_de_baja', 'Dado de Baja'), ('siniestrado', 'Siniestrado'), ('transferido', 'Transferido')], default='activo', max_length=20, verbose_name='Estado')),

                ('condicion', models.CharField(choices=[('excelente', 'Excelente'), ('bueno', 'Bueno'), ('regular', 'Regular'), ('malo', 'Malo')], default='bueno', max_length=20, verbose_name='Condición Física')),

                ('fecha_adquisicion', models.DateField(blank=True, null=True, verbose_name='Fecha de Adquisición')),

                ('fecha_garantia', models.DateField(blank=True, null=True, verbose_name='Vencimiento de Garantía')),

                ('imagen', models.TextField(blank=True, max_length=100, null=True, verbose_name='Imagen del Bien')),

                ('codigo_qr', models.CharField(blank=True, help_text='Código QR para identificación rápida', max_length=200, verbose_name='Código QR')),

                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),

                ('activo', models.BooleanField(default=True, verbose_name='Activo')),

                ('fecha_creacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),

                ('history_id', models.AutoField(primary_key=True, serialize=False)),

                ('history_date', models.DateTimeField(db_index=True)),

                ('history_change_reason', models.CharField(max_length=100, null=True)),

                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),

                ('creado_por', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('grupo_bienes', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.grupobienes', verbose_name='Grupo de Bienes')),

                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),

                ('poliza', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.poliza', verbose_name='Póliza')),

                ('responsable_custodio', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.responsablecustodio', verbose_name='Responsable/Custodio')),

                ('subgrupo_ramo', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.subgruporamo', verbose_name='Subgrupo de Ramo')),

            ],

            options={

                'verbose_name': 'Historial',

                'verbose_name_plural': 'Historial de cambios',

                'ordering': ('-history_date', '-history_id'),

                'get_latest_by': ('history_date', 'history_id'),

            },

            bases=(simple_history.models.HistoricalChanges, models.Model),

        ),

        migrations.AddField(

            model_name='grupobienes',

            name='subgrupo_ramo',

            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='grupos_bienes', to='app.subgruporamo', verbose_name='Subgrupo de Ramo'),

        ),

        migrations.CreateModel(

            name='DetallePolizaRamo',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('numero_factura', models.CharField(blank=True, max_length=100, verbose_name='N° Factura')),

                ('documento_contable', models.CharField(blank=True, max_length=100, verbose_name='Doc. Contable')),

                ('suma_asegurada', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Suma Asegurada')),

                ('total_prima', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Prima Total')),

                ('contribucion_superintendencia', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Contribución Superintendencia (3.5%)')),

                ('emision', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Emisión')),

                ('seguro_campesino', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Seguro Campesino (0.5%)')),

                ('base_imponible', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Base Imponible')),

                ('iva', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='IVA (15%)')),

                ('total_facturado', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Total Facturado')),

                ('retencion_prima', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Retención Prima (1%)')),

                ('retencion_iva', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Retención IVA (100%)')),

                ('valor_por_pagar', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=15, verbose_name='Valor por Pagar')),

                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

                ('grupo_ramo', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='detalles_poliza', to='app.gruporamo', verbose_name='Grupo de Ramo')),

                ('poliza', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='detalles_ramo', to='app.poliza', verbose_name='Póliza')),

                ('subgrupo_ramo', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='detalles_poliza', to='app.subgruporamo', verbose_name='Subgrupo de Ramo')),

            ],

            options={

                'verbose_name': 'Detalle de Póliza por Ramo',

                'verbose_name_plural': 'Detalles de Póliza por Ramo',

                'ordering': ['poliza', 'grupo_ramo__nombre'],

            },

        ),

        migrations.AddField(

            model_name='bienasegurado',

            name='subgrupo_ramo',

            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='bienes_asegurados', to='app.subgruporamo', verbose_name='Subgrupo de Ramo'),

        ),

        migrations.CreateModel(

            name='HistoricalQuote',

            fields=[

                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),

                ('quote_number', models.CharField(db_index=True, max_length=100, verbose_name='Número de Cotización')),

                ('title', models.CharField(max_length=200, verbose_name='Título/Descripción')),

                ('sum_insured', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Suma a Asegurar')),

                ('coverage_details', models.TextField(verbose_name='Detalle de Coberturas Solicitadas')),

                ('request_date', models.DateField(verbose_name='Fecha de Solicitud')),

                ('valid_until', models.DateField(verbose_name='Válida Hasta')),

                ('desired_start_date', models.DateField(verbose_name='Fecha de Inicio Deseada')),

                ('desired_end_date', models.DateField(verbose_name='Fecha de Fin Deseada')),

                ('status', models.CharField(choices=[('draft', 'Borrador'), ('sent', 'Enviada'), ('under_review', 'En Revisión'), ('accepted', 'Aceptada'), ('rejected', 'Rechazada'), ('expired', 'Expirada'), ('converted', 'Convertida a Póliza')], default='draft', max_length=20, verbose_name='Estado')),

                ('priority', models.CharField(choices=[('low', 'Baja'), ('medium', 'Media'), ('high', 'Alta'), ('urgent', 'Urgente')], default='medium', max_length=20, verbose_name='Prioridad')),

                ('notes', models.TextField(blank=True, verbose_name='Notas Internas')),

                ('rejection_reason', models.TextField(blank=True, verbose_name='Motivo de Rechazo')),

                ('created_at', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),

                ('updated_at', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),

                ('history_id', models.AutoField(primary_key=True, serialize=False)),

                ('history_date', models.DateTimeField(db_index=True)),

                ('history_change_reason', models.CharField(max_length=100, null=True)),

                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),

                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),

                ('requested_by', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Solicitado por')),

                ('resulting_policy', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.poliza', verbose_name='Póliza Resultante')),

                ('policy_type', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.tipopoliza', verbose_name='Tipo de Póliza')),

            ],

            options={

                'verbose_name': 'Historial',

                'verbose_name_plural': 'Historial de cambios',

                'ordering': ('-history_date', '-history_id'),

                'get_latest_by': ('history_date', 'history_id'),

            },

            bases=(simple_history.models.HistoricalChanges, models.Model),

        ),

        migrations.CreateModel(

            name='HistoricalPoliza',

            fields=[

                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),

                ('numero_poliza', models.CharField(db_index=True, max_length=100, verbose_name='Número de Póliza')),

                ('suma_asegurada', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Suma Asegurada')),

                ('coberturas', models.TextField(verbose_name='Coberturas Detalladas')),

                ('prima_neta', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Costo base del seguro sin impuestos ni contribuciones', max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Prima Neta')),

                ('prima_total', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Prima neta + IVA + contribuciones', max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Prima Total')),

                ('deducible', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Monto que asume el asegurado en cada siniestro', max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Deducible')),

                ('porcentaje_deducible', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Porcentaje del siniestro que asume el asegurado (alternativo al monto fijo)', max_digits=5, validators=[django.core.validators.MinValueValidator(Decimal('0.00')), django.core.validators.MaxValueValidator(Decimal('100.00'))], verbose_name='% Deducible')),

                ('deducible_minimo', models.DecimalField(decimal_places=2, default=Decimal('0.00'), help_text='Monto mínimo de deducible cuando se usa porcentaje', max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.00'))], verbose_name='Deducible Mínimo')),

                ('fecha_inicio', models.DateField(verbose_name='Fecha de Inicio de Vigencia')),

                ('fecha_fin', models.DateField(verbose_name='Fecha de Fin de Vigencia')),

                ('estado', models.CharField(choices=[('vigente', 'Vigente'), ('vencida', 'Vencida'), ('cancelada', 'Cancelada'), ('por_vencer', 'Por Vencer')], default='vigente', max_length=20, verbose_name='Estado')),

                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),

                ('es_gran_contribuyente', models.BooleanField(default=False, help_text='Si está activo, se aplicarán retenciones de prima (1%) e IVA (100%)', verbose_name='Es Gran Contribuyente')),

                ('fecha_creacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),

                ('history_id', models.AutoField(primary_key=True, serialize=False)),

                ('history_date', models.DateTimeField(db_index=True)),

                ('history_change_reason', models.CharField(max_length=100, null=True)),

                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),

                ('compania_aseguradora', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.companiaaseguradora', verbose_name='Compañía Aseguradora')),

                ('corredor_seguros', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.corredorseguros', verbose_name='Corredor de Seguros')),

                ('creado_por', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('grupo_ramo', models.ForeignKey(blank=True, db_constraint=False, help_text='Categoría de la póliza según clasificación de ramos', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.gruporamo', verbose_name='Grupo de Ramo')),

                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),

                ('tipo_poliza', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.tipopoliza', verbose_name='Tipo de Póliza')),

            ],

            options={

                'verbose_name': 'Historial',

                'verbose_name_plural': 'Historial de cambios',

                'ordering': ('-history_date', '-history_id'),

                'get_latest_by': ('history_date', 'history_id'),

            },

            bases=(simple_history.models.HistoricalChanges, models.Model),

        ),

        migrations.CreateModel(

            name='TipoRamo',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('codigo', models.CharField(max_length=50, unique=True, verbose_name='Código')),

                ('nombre', models.CharField(max_length=200, verbose_name='Nombre del Tipo')),

                ('descripcion', models.TextField(blank=True, verbose_name='Descripción')),

                ('activo', models.BooleanField(default=True, verbose_name='Activo')),

                ('es_predefinido', models.BooleanField(default=False, help_text='Los tipos predefinidos no pueden eliminarse', verbose_name='Es Predefinido')),

                ('fecha_creacion', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),

                ('fecha_modificacion', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),

            ],

            options={

                'verbose_name': 'Tipo de Ramo',

                'verbose_name_plural': 'Tipos de Ramo',

                'ordering': ['nombre'],

                'indexes': [models.Index(fields=['codigo'], name='app_tiporam_codigo_c9b36a_idx'), models.Index(fields=['activo'], name='app_tiporam_activo_e8911a_idx')],

            },

        ),

        migrations.AddField(

            model_name='gruporamo',

            name='tipo_ramo',

            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='grupos', to='app.tiporamo', verbose_name='Tipo de Ramo'),

        ),

        migrations.CreateModel(

            name='HistoricalSiniestro',

            fields=[

                ('id', models.BigIntegerField(auto_created=True, blank=True, db_index=True, verbose_name='ID')),

                ('numero_siniestro', models.CharField(db_index=True, max_length=100, verbose_name='Número de Siniestro')),

                ('fecha_siniestro', models.DateTimeField(verbose_name='Fecha y Hora del Siniestro')),

                ('fecha_registro', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Registro')),

                ('bien_nombre', models.CharField(blank=True, default='', help_text='Campo legacy: usar bien_asegurado en su lugar', max_length=200, verbose_name='Nombre del Bien')),

                ('bien_modelo', models.CharField(blank=True, max_length=100, verbose_name='Modelo')),

                ('bien_serie', models.CharField(blank=True, max_length=100, verbose_name='Número de Serie')),

                ('bien_marca', models.CharField(blank=True, max_length=100, verbose_name='Marca')),

                ('bien_codigo_activo', models.CharField(blank=True, max_length=100, verbose_name='Código de Activo')),

                ('ubicacion', models.CharField(max_length=300, verbose_name='Ubicación del Siniestro')),

                ('causa', models.TextField(verbose_name='Causa del Siniestro')),

                ('descripcion_detallada', models.TextField(verbose_name='Descripción Detallada')),

                ('monto_estimado', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Monto Estimado del Daño')),

                ('monto_indemnizado', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Monto Indemnizado')),

                ('valor_reclamo', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Valor del Reclamo (según proforma)')),

                ('deducible_aplicado', models.DecimalField(blank=True, decimal_places=2, help_text='Deducible efectivamente aplicado en este siniestro (calculado desde la póliza)', max_digits=15, null=True, verbose_name='Deducible Aplicado')),

                ('depreciacion', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Depreciación')),

                ('suma_asegurada_bien', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Suma Asegurada del Bien')),

                ('email_broker', models.EmailField(blank=True, help_text='Email específico para este siniestro', max_length=254, verbose_name='Email del Broker')),

                ('estado', models.CharField(choices=[('registrado', 'Registrado'), ('documentacion_pendiente', 'Documentación Pendiente'), ('enviado_aseguradora', 'Enviado a Aseguradora'), ('en_evaluacion', 'En Evaluación'), ('aprobado', 'Aprobado'), ('rechazado', 'Rechazado'), ('liquidado', 'Liquidado'), ('cerrado', 'Cerrado')], default='registrado', max_length=30, verbose_name='Estado')),

                ('fecha_envio_aseguradora', models.DateField(blank=True, null=True, verbose_name='Fecha de Envío a Aseguradora')),

                ('fecha_respuesta_aseguradora', models.DateField(blank=True, null=True, verbose_name='Fecha de Respuesta de Aseguradora')),

                ('fecha_liquidacion', models.DateField(blank=True, null=True, verbose_name='Fecha de Liquidación')),

                ('fecha_notificacion_broker', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Notificación al Broker')),

                ('fecha_respuesta_esperada', models.DateField(blank=True, null=True, verbose_name='Fecha de Respuesta Esperada (5 días hábiles)')),

                ('fecha_notificacion_responsable', models.DateField(blank=True, null=True, verbose_name='Fecha de Notificación al Responsable')),

                ('fecha_firma_indemnizacion', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Firma del Recibo de Indemnización')),

                ('fecha_limite_deposito', models.DateField(blank=True, null=True, verbose_name='Fecha Límite de Depósito (72h)')),

                ('valor_pagado', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True, verbose_name='Valor Pagado')),

                ('fecha_pago', models.DateField(blank=True, null=True, verbose_name='Fecha de Pago')),

                ('observaciones', models.TextField(blank=True, verbose_name='Observaciones')),

                ('fecha_modificacion', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),

                ('history_id', models.AutoField(primary_key=True, serialize=False)),

                ('history_date', models.DateTimeField(db_index=True)),

                ('history_change_reason', models.CharField(max_length=100, null=True)),

                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),

                ('bien_asegurado', models.ForeignKey(blank=True, db_constraint=False, help_text='Bien específico afectado por el siniestro', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.bienasegurado', verbose_name='Bien Asegurado')),

                ('creado_por', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL, verbose_name='Creado por')),

                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),

                ('poliza', models.ForeignKey(blank=True, db_constraint=False, help_text='Póliza asociada (se obtiene automáticamente del bien asegurado)', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.poliza', verbose_name='Póliza')),

                ('responsable_custodio', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.responsablecustodio', verbose_name='Responsable/Custodio')),

                ('tipo_siniestro', models.ForeignKey(blank=True, db_constraint=False, null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='app.tiposiniestro', verbose_name='Tipo de Siniestro')),

            ],

            options={

                'verbose_name': 'Historial',

                'verbose_name_plural': 'Historial de cambios',

                'ordering': ('-history_date', '-history_id'),

                'get_latest_by': ('history_date', 'history_id'),

            },

            bases=(simple_history.models.HistoricalChanges, models.Model),

        ),

        migrations.AddField(

            model_name='checklistsiniestroconfig',

            name='tipo_siniestro',

            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='checklist_config', to='app.tiposiniestro', verbose_name='Tipo de Siniestro'),

        ),

        migrations.CreateModel(

            name='PaymentApproval',

            fields=[

                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),

                ('approval_level', models.CharField(choices=[('level_1', 'Nivel 1 - Operativo'), ('level_2', 'Nivel 2 - Supervisión'), ('level_3', 'Nivel 3 - Gerencial'), ('level_4', 'Nivel 4 - Directivo')], max_length=20, verbose_name='Nivel de Aprobación')),

                ('required_level', models.CharField(choices=[('level_1', 'Nivel 1 - Operativo'), ('level_2', 'Nivel 2 - Supervisión'), ('level_3', 'Nivel 3 - Gerencial'), ('level_4', 'Nivel 4 - Directivo')], max_length=20, verbose_name='Nivel Requerido')),

                ('status', models.CharField(choices=[('pending', 'Pendiente'), ('approved', 'Aprobado'), ('rejected', 'Rechazado'), ('cancelled', 'Cancelado')], default='pending', max_length=20, verbose_name='Estado')),

                ('requested_at', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Solicitud')),

                ('decided_at', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Decisión')),

                ('request_notes', models.TextField(blank=True, verbose_name='Notas de Solicitud')),

                ('decision_notes', models.TextField(blank=True, verbose_name='Notas de Decisión')),

                ('digital_signature', models.BooleanField(default=False, verbose_name='Firma Digital/Confirmación')),

                ('approver', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='payment_approvals', to=settings.AUTH_USER_MODEL, verbose_name='Aprobador')),

                ('payment', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='approvals', to='app.pago', verbose_name='Pago')),

            ],

            options={

                'verbose_name': 'Aprobación de Pago',

                'verbose_name_plural': 'Aprobaciones de Pagos',

                'ordering': ['-requested_at'],

                'indexes': [models.Index(fields=['status'], name='app_payment_status_cc78d3_idx'), models.Index(fields=['approval_level'], name='app_payment_approva_0722d5_idx')],

            },

        ),

        migrations.AddIndex(

            model_name='factura',

            index=models.Index(fields=['numero_factura'], name='app_factura_numero__3957b1_idx'),

        ),

        migrations.AddIndex(

            model_name='factura',

            index=models.Index(fields=['estado', 'fecha_vencimiento'], name='app_factura_estado_b9d9f3_idx'),

        ),

        migrations.AddIndex(

            model_name='policyrenewal',

            index=models.Index(fields=['renewal_number'], name='app_policyr_renewal_f549ea_idx'),

        ),

        migrations.AddIndex(

            model_name='policyrenewal',

            index=models.Index(fields=['status'], name='app_policyr_status_1df26b_idx'),

        ),

        migrations.AddIndex(

            model_name='policyrenewal',

            index=models.Index(fields=['due_date'], name='app_policyr_due_dat_c99a34_idx'),

        ),

        migrations.AddIndex(

            model_name='notificacionemail',

            index=models.Index(fields=['tipo', 'estado'], name='app_notific_tipo_d7ec10_idx'),

        ),

        migrations.AddIndex(

            model_name='notificacionemail',

            index=models.Index(fields=['fecha_creacion'], name='app_notific_fecha_c_1b58f8_idx'),

        ),

        migrations.AlterUniqueTogether(

            name='checklistsiniestro',

            unique_together={('siniestro', 'config_item')},

        ),

        migrations.AddIndex(

            model_name='calendarevent',

            index=models.Index(fields=['start_date'], name='app_calenda_start_d_7c8fe0_idx'),

        ),

        migrations.AddIndex(

            model_name='calendarevent',

            index=models.Index(fields=['event_type'], name='app_calenda_event_t_46f0fe_idx'),

        ),

        migrations.AddIndex(

            model_name='calendarevent',

            index=models.Index(fields=['priority'], name='app_calenda_priorit_6bdba0_idx'),

        ),

        migrations.AddIndex(

            model_name='siniestroemail',

            index=models.Index(fields=['serie'], name='app_siniest_serie_d82897_idx'),

        ),

        migrations.AddIndex(

            model_name='siniestroemail',

            index=models.Index(fields=['estado_procesamiento'], name='app_siniest_estado__441067_idx'),

        ),

        migrations.AddIndex(

            model_name='siniestroemail',

            index=models.Index(fields=['email_id'], name='app_siniest_email_i_c17685_idx'),

        ),

        migrations.AddIndex(

            model_name='subgruporamo',

            index=models.Index(fields=['codigo'], name='app_subgrup_codigo_090ec2_idx'),

        ),

        migrations.AddIndex(

            model_name='subgruporamo',

            index=models.Index(fields=['activo'], name='app_subgrup_activo_9ad9dc_idx'),

        ),

        migrations.AlterUniqueTogether(

            name='subgruporamo',

            unique_together={('grupo_ramo', 'codigo')},

        ),

        migrations.AddIndex(

            model_name='grupobienes',

            index=models.Index(fields=['grupo_ramo'], name='app_grupobi_grupo_r_003af9_idx'),

        ),

        migrations.AddIndex(

            model_name='grupobienes',

            index=models.Index(fields=['activo'], name='app_grupobi_activo_c1f2c1_idx'),

        ),

        migrations.AddIndex(

            model_name='detallepolizaramo',

            index=models.Index(fields=['poliza', 'grupo_ramo'], name='app_detalle_poliza__0396e1_idx'),

        ),

        migrations.AddIndex(

            model_name='bienasegurado',

            index=models.Index(fields=['codigo_bien'], name='app_bienase_codigo__fda85f_idx'),

        ),

        migrations.AddIndex(

            model_name='bienasegurado',

            index=models.Index(fields=['poliza', 'estado'], name='app_bienase_poliza__947db7_idx'),

        ),

        migrations.AddIndex(

            model_name='bienasegurado',

            index=models.Index(fields=['subgrupo_ramo'], name='app_bienase_subgrup_34ccbf_idx'),

        ),

        migrations.AddIndex(

            model_name='bienasegurado',

            index=models.Index(fields=['codigo_activo'], name='app_bienase_codigo__b65cb5_idx'),

        ),

        migrations.AddIndex(

            model_name='quote',

            index=models.Index(fields=['quote_number'], name='app_quote_quote_n_e320c3_idx'),

        ),

        migrations.AddIndex(

            model_name='quote',

            index=models.Index(fields=['status'], name='app_quote_status_de8c03_idx'),

        ),

        migrations.AddIndex(

            model_name='poliza',

            index=models.Index(fields=['numero_poliza'], name='app_poliza_numero__7f8b4e_idx'),

        ),

        migrations.AddIndex(

            model_name='poliza',

            index=models.Index(fields=['estado', 'fecha_fin'], name='app_poliza_estado_5bbb33_idx'),

        ),

        migrations.AddIndex(

            model_name='gruporamo',

            index=models.Index(fields=['codigo'], name='app_grupora_codigo_08e8a1_idx'),

        ),

        migrations.AddIndex(

            model_name='gruporamo',

            index=models.Index(fields=['activo'], name='app_grupora_activo_dc7a83_idx'),

        ),

        migrations.AlterUniqueTogether(

            name='gruporamo',

            unique_together={('tipo_ramo', 'codigo')},

        ),

        migrations.AddIndex(

            model_name='siniestro',

            index=models.Index(fields=['numero_siniestro'], name='app_siniest_numero__99d840_idx'),

        ),

        migrations.AddIndex(

            model_name='siniestro',

            index=models.Index(fields=['estado', 'fecha_siniestro'], name='app_siniest_estado_4e7841_idx'),

        ),

        migrations.AddIndex(

            model_name='siniestro',

            index=models.Index(fields=['bien_asegurado'], name='app_siniest_bien_as_49ac1e_idx'),

        ),

        migrations.AlterUniqueTogether(

            name='checklistsiniestroconfig',

            unique_together={('tipo_siniestro', 'nombre')},

        ),

    ]

